"use strict";Parse.initialize("GALoEHmMmowxBPoiHn0HD0VvBME0xot18o3xLIXy","a3iUHr0DVR9GJ3mFCiQcPLSz7WVSYTeV6x7pgKfY");var Documents=Parse.Object.extend({className:"Documents",defaults:{CardNumber:"",CardType:"",CourseType:"",DateIssued:"",DateOfBirth:"",Instructor:"",StateIssued:""}}),DocumentsCollection=Parse.Collection.extend({model:Documents}),NavigationView=Parse.View.extend({className:"navigationView",template:_.template($(".navigation-template").text()),events:{"click .sign-up-page-btn":"toSignUpPage","click .sign-in-page-btn":"toSignInPage","click .user-settings-btn":"toSettingsPage","click .user-sign-out-btn":"userSignOut"},initialize:function(){this.model=new Parse.Object,this.update(),$(".navbar-right").append(this.el)},update:function(){this.model.set("currentUser",Parse.User.current()),this.render()},render:function(){var a=this.template(this.model.attributes);this.$el.html(a)},toSignUpPage:function(){router.navigate("#/sign-up",{trigger:!0})},toSignInPage:function(){router.navigate("#/sign-in",{trigger:!0})},toSettingsPage:function(){router.navigate("#/settings",{trigger:!0})},userSignOut:function(){Parse.User.logOut(),this.update(),router.navigate("",{trigger:!0})}}),LandingPage=Parse.View.extend({className:"landingPage",template:_.template($(".landing-page-template").text()),initialize:function(){$(".content").append(this.el),this.render()},render:function(){var a=this.template;this.$el.html(a)}}),SignUpPage=Parse.View.extend({className:"signUpPage",template:_.template($(".sign-up-template").text()),events:{"click .new-user-btn":"createNewUser"},initialize:function(){$(".content").append(this.el),this.render()},render:function(){var a=this.template;this.$el.html(a)},createNewUser:function(){var a=$(".user-firstname-input").val(),b=$(".user-lastname-input").val(),c=$(".user-email-input").val(),d=$(".user-email-input").val(),e=$(".user-password-input").val(),f=$(".user-gender-input").val(),g=$(".user-dob-input").val(),h=$(".user-stateresidence-input").val(),i=new Parse.User;i.set("firstname",a),i.set("lastname",b),i.set("username",c),i.set("email",d),i.set("password",e),i.set("gender",f),i.set("dob",g),i.set("stateresidence",h),i.signUp(null,{success:function(a){console.log("Username:",a.get("username"),"is logged in."),router.updateNavView(),router.navigate("#/dashboard",{trigger:!0})},error:function(a,b){alert("Error: "+b.code+b.message)}})}}),SignInPage=Parse.View.extend({className:"signInPage",template:_.template($(".sign-in-template").text()),events:{"click .sign-in-btn":"userSignIn"},initialize:function(){$(".content").append(this.el),this.render()},render:function(){var a=this.template;this.$el.html(a)},userSignIn:function(){var a=$(".user-email-input").val(),b=$(".user-password-input").val();Parse.User.logIn(a,b,{success:function(a){console.log("Username:",a.get("username"),"is logged in."),router.updateNavView(),router.navigate("#/dashboard",{trigger:!0})},error:function(a,b){console.log("User not logged in: "+b.code+" "+b.message),alert("There was an error signing in. Please try again.")}})},enableEnter:function(){$(".user-password-input").keypress(function(a){13===a.which&&$(".user-signIn-btn").click()})},userPwdReset:function(){router.navigate("#/password-reset",{trigger:!0})}}),PwdResetPage=Parse.View.extend({className:"pwdResetPage",template:_.template($(".pwd-reset-template").text()),events:{"click .pwd-reset-btn":"userPwdReset"},initialize:function(){$(".content").append(this.el),this.render()},render:function(){var a=this.template;this.$el.html(a)},userPwdReset:function(){var a=$(".lookup-email-input").val();Parse.User.requestPasswordReset(a,{success:function(){router.navigate("#/sign-in",{trigger:!0})},error:function(a){alert("Error: "+a.code+a.message)}})}}),UserDashboardPage=Parse.View.extend({template:_.template($(".user-dashboard-template").text()),initialize:function(){$(".content").append(this.el);var a=this;Parse.User.current().relation("documents").query().find().done(function(b){a.collection=new Parse.Collection(b),a.render()})},render:function(){var a=this.template({collection:this.collection.toJSON()});this.$el.html(a)}}),DocumentUploadPage=Parse.View.extend({template:_.template($(".document-upload-template").text()),events:{"click .add-document-btn":"addDocument","click .delete-document-btn":"deleteDocument"},initialize:function(){$(".content").append(this.el),this.render()},render:function(){var a=this.model||{},b=this.template(a.attributes);this.$el.html(b)},addDocument:function(){var a=$(".document-upload")[0];if(a.files.length>0)var b=a.files[0],c="documentImage.jpg",d=new Parse.File(c,b),e=$(".card-number-input").val(),f=$(".card-type-input").val(),g=$(".course-type-input").val(),h=$(".date-issued-input").val(),i=$(".dob-input").val(),j=$(".instructor-input").val(),k=$(".state-issued-input").val();var l=this;d.save().then(function(){console.log("I've been saved!");var a=new Documents;a.set("CardNumber",e),a.set("CardType",f),a.set("CourseType",g),a.set("DateIssued",h),a.set("DateOfBirth",i),a.set("Instructor",j),a.set("StateIssued",k),a.set("documentRef",d),a.set("docURL",d.url()),a.save().done(function(){l.render(),Parse.User.current().relation("documents").add(a),Parse.User.current().save()}),l.model=a},function(a){alert("Failed to create new object, with error code: "+a.description)})},deleteDocument:function(){this.model.destroy(),this.model=new Parse.Object,this.render()}}),DocumentDetailPage=Parse.View.extend({template:_.template($(".document-detail-template").text()),events:{"click .delete-document-btn":"deleteDocument"},initialize:function(a){var b=a.id;$(".content").append(this.el);var c=this;Parse.User.current().relation("documents").query().get(b).then(function(a){c.model=a,c.render()})},render:function(){var a=this.template(this.model.attributes);this.$el.html(a)},deleteDocument:function(){this.model.destroy(),router.navigate("#/document-upload",{trigger:!0})}}),UserSettingsPage=Parse.View.extend({className:"userSettingsPage",template:_.template($(".user-settings-template").text()),events:{},initialize:function(){$(".content").append(this.el),this.render()},render:function(){var a=this.template;this.$el.html(a)}}),AppRouter=Parse.Router.extend({routes:{"":"landingPage","sign-up":"userSignUp","sign-in":"userSignIn","password-reset":"userPwdReset",dashboard:"userDashboard","document-upload":"documentUpload","document/:id":"documentDetail"},initialize:function(){this.navView=new NavigationView,this.currentView=null},updateNavView:function(){this.navView.update()},landingPage:function(){Parse.User.current()?router.navigate("#/dashboard",{trigger:!0}):($(".content").html(""),new LandingPage)},userSignUp:function(){$(".content").html(""),new SignUpPage},userSignIn:function(){$(".content").html(""),new SignInPage},userPwdReset:function(){$(".content").html(""),new PwdResetPage},userDashboard:function(){Parse.User.current()?($(".content").html(""),new UserDashboardPage):router.navigate("",{trigger:!0})},documentUpload:function(){Parse.User.current()?($(".content").html(""),new DocumentUploadPage):router.navigate("",{trigger:!0})},documentDetail:function(a){Parse.User.current()?($(".content").html(""),new DocumentDetailPage({id:a})):router.navigate("",{trigger:!0})}}),router=new AppRouter;Parse.history.start();